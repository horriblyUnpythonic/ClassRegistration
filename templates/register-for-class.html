<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>REGISTER</title>
    {% load staticfiles %}
</head>
<body>

<h1>
    REGISTRATION
</h1>

<h3>Course Offering Preferences</h3>

{#<form action='/dumb/' method="post">#}
<form method="post">
    {% csrf_token %}
    <ul class="sortable">
        {% for pref in course_preference %}
            <li>
                <input value='{{ pref }}-checkbox' type="checkbox" checked>
                <label for="{{ pref.id }}">{{ pref }}</label>
                <input class="preference-order" hidden id="{{ pref.id }}" name="{{ pref }}" value="">
            </li>
        {% endfor %}
        {% for offering in course_offering %}
            {% if offering not in course_preference %}
                <li>
                    <input value='{{ offering }}-checkbox' type="checkbox">
                    <label for="{{ offering.id }}">{{ offering }}</label>
                    <input class="preference-order" hidden id="{{ offering.id }}" name="{{ offering }}" value="">
                </li>
            {% endif %}
        {% endfor %}
    </ul>

    <input type="submit" value="dumb form" onclick="return beforeSubmit()" />
</form>

{#<button onclick="submit()">#}
{#    {% csrf_token %}#}
{#    submit button onclick#}
{#</button>#}

{#<script>#}
{#    function submit() {#}
{#        alert('hello submit');#}
{#        $.post('/register/', 'POST', {});#}
{#        return false;#}
{#    }#}
{#</script>#}

<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
<script src="{% static "/html5sortable/jquery.sortable.js" %}"></script>
{#<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>#}
<script>
    $('.sortable').sortable();

    function beforeSubmit() {
        console.log('before submit');
        const preferences = document.getElementsByClassName("preference-order");
        for(let i = 0; i < preferences.length; i++ ) {
            preferences[i].value = i;
            console.log(preferences[i]);
        }
        return true
    }

</script>

</body>
</html>